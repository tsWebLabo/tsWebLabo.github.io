<!doctype html>
<html lang="ja">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="author" content="t's Web Labo">
    <meta name="keywords" content="パソコン, プログラミング, Ubuntu, Androidアプリ開発">
    <meta name="description" content="はじめまして、t's Web Laboの「たむ」と申します。
    「プログラミングって楽しい」を多くの方と共有したいと思っています。Webサイト作成をはじめとして様々なアプリケーション開発に挑戦します。
    現状私のスキルは高くはないですが、当サイトやYouTubeライブ配信を通して少しずつ成長していきますので応援して頂けると嬉しいです。">

    <!-- favicon -->
    <link rel="shortcut icon" href="../images/tsweblabo.ico" type="image/x-icon">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <!-- custom CSS -->
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="../css/lowerPage.css">
    <title>t's Web Labo</title>
  </head>
  <body>
    <!--navbar-->
    <nav class="navbar fixed-top navbar-expand-lg navbar-dark">
      <div class="navbar-brand">
          <img src="../images/tsweblabo_Logo02.png" width="30" height="30" class="d-inline-block align-top" alt="">
          t's Web Labo
      </div>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
    
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav ml-auto">
          <!-- index -->
          <li class="nav-item">
            <a class="nav-link" href="../index.html">Home <span class="sr-only">(current)</span></a>
          </li>
          <!-- tools -->
          <li class="nav-item dropdown drop-hover">
            <a href="#" class="nav-link dropdown-toggle" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              ツール
            </a>
            <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
              <li class="dropright drop-hover">
                <a class="dropdown-item dropdown-toggle" href="../ubuntu/ubuntu001.html" type="button" data-toggle="dropdown">
                  Ubuntu
                </a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="../ubuntu/ubuntu001.html">Ubuntuってなに？</a>
                  <a class="dropdown-item" href="../ubuntu/ubuntu002.html">Linuxコマンド</a>
                  <a class="dropdown-item" href="../ubuntu/ubuntu003.html">ShellScript</a>
                </div>
              </li>
              <li class="dropright drop-hover"> 
                <a class="dropdown-item dropdown-toggle" href="../vim/vim001.html" type="button" data-toggle="dropdown">
                  Vim
                </a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="../vim/vim001.html">インストールと設定</a>
                  <a class="dropdown-item" href="../vim/vim002.html">モード・基本操作</a>
                </div>
              </li>
            </ul>
          </li>
          <!-- programming -->
          <li class="nav-item dropdown drop-hover">
            <a href="#" class="nav-link dropdown-toggle active" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              プログラミング
            </a>
            <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
              <li class="dropright drop-hover">
                <a class="dropdown-item dropdown-toggle active" href="../androidApp/androidApp001.html" class="nav-link dropdown-toggle" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  Androidアプリ
                </a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="../androidApp/androidApp001.html">Basic-Tips</a>
                  <a class="dropdown-item active" href="../androidApp/androidApp002.html">データベースアクセス</a>
                  <a class="dropdown-item" href="../androidApp/androidApp003.html">Androidアプリの紹介</a>
                </div>
              </li>
              <li class="dropright drop-hover">
                <a class="dropdown-item dropdown-toggle" href="../sqlite3/sqlite3_001.html" class="nav-link dropdown-toggle" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  SQLite3
                </a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="../sqlite3/sqlite3_001.html">SQLite3とは</a>
                  <a class="dropdown-item" href="../sqlite3/sqlite3_002.html">データベースの操作</a>
                  <a class="dropdown-item" href="../sqlite3/sqlite3_003.html">テーブルの操作</a>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item" href="../sqlite3/sqlite3_004.html">データの追加（INSERT文）</a>
                  <a class="dropdown-item" href="../sqlite3/sqlite3_005.html">データの更新（UPDATE文）</a>
                  <a class="dropdown-item" href="../sqlite3/sqlite3_006.html">データの削除（DELETE文）</a>
                  <a class="dropdown-item" href="../sqlite3/sqlite3_007.html">データの取得（SELECT文）</a>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item" href="../sqlite3/sqlite3_008.html">テーブルの結合（JOIN句）</a>
                </div>
              </li>
              <li class="dropright drop-hover">
                <a class="dropdown-item dropdown-toggle" href="../javascriptNote/javascriptNote_001.html" class="nav-link dropdown-toggle" id="navbarDropdown" role="button" data-toggle="dropdown", aria-haspopup="true" aria-expanded="false">
                  JavaScript
                </a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="../javascriptNote/javascriptNote_001.html">JavaScriptとは</a>
                  <a class="dropdown-item" href="../javascriptNote/javascriptNote_002.html">演算子</a>
                  <a class="dropdown-item" href="../javascriptNote/javascriptNote_003.html">配列</a>
                  <a class="dropdown-item" href="../javascriptNote/javascriptNote_004.html">代入</a>
                  <a class="dropdown-item" href="../javascriptNote/javascriptNote_005.html">条件分岐</a>
                  <a class="dropdown-item" href="../javascriptNote/javascriptNote_006.html">try...catch文</a>
                  <a class="dropdown-item" href="../javascriptNote/javascriptNote_007.html">繰り返し</a>
                  <a class="dropdown-item" href="../javascriptNote/javascriptNote_008.html">関数</a>
                  <a class="dropdown-item" href="../javascriptNote/javascriptNote_009.html">画面入出力</a>
                  <a class="dropdown-item" href="../javascriptNote/javascriptNote_010.html">処理の呼び出し</a>
                  <a class="dropdown-item" href="../javascriptNote/javascriptNote_011.html">データベースアクセス</a>
                </div>
              </li>
              <li class="dropright drop-hover">
                <a class="dropdown-item dropdown-toggle" href="../Nodejs/nodejs_001.html" class="nav-link dropdown-toggle" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  Node.js
                </a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="../Nodejs/nodejs_001.html">Node.js</a>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item" href="../Nodejs/expressApp.html">Express</a>
                  <a class="dropdown-item" href="../Nodejs/express_generator.html">Express-generator</a>
                </div>
              </li>
            </ul>
          </li>
          <!-- aboutme -->
          <li class="nav-item">
            <a class="nav-link" href="../aboutme.html">About me</a>
          </li>    
        </ul>
      </div>
    </nav>
      <section>
        <!--jumbotron-->
        <div class="jumbotron">
          <h1 class="display-4 text-accent text-bright">Androidアプリ制作に挑戦！！</h1>
          <p class="lead">YouTubeライブ配信でつくったスマホアプリを紹介します。ソースコードやスクリーンショットを掲載していきます。</p>
          <hr class="my-4">
          <p class="lead">
            Androidアプリには組み込み型データベースである「SQLite3」が使えるようになっています。<br>
            データベースを使ってより高度なアプリ制作が可能です。
          </p>
        </div>
        <h2>データベースアクセス</h2>
        <ul>
          <li>Androidアプリでは組み込み型データベースのSQLite3が使える</li>
          <li>SQLite3を使ったアプリを作る際には、SQLiteOpenHelperクラスを継承したクラスを定義する</li>
        </ul>

        <h3>アクティビティ（画面）をつくる</h3>
        <p>
          1枚のアクティビティにSQL文の「INSERT文」「UPDATE文」「DELETE文」「SELECT文」の機能を全て実装することは可能ですが、<br>
          スマートフォンなどの小さな画面で扱うので操作が煩雑になりやすいため、機能ごとにアクティビティを分けたほうが使いやすくなります。
        </p>

        <h4>1つめのアクティビティ（INSERT文）</h4>
        <img src="images/DatabaseAppEmulator001.png" alt="DatabaseApp activity_main エミュレータ画像">
        <h5>activity_main.xml</h5>
        <div class="media">
          <pre>
            <code>
              &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
              &lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
                  xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
                  xmlns:tools=&quot;http://schemas.android.com/tools&quot;
                  android:orientation=&quot;vertical&quot;
                  android:layout_width=&quot;match_parent&quot;
                  android:layout_height=&quot;match_parent&quot;
                  tools:context=&quot;.MainActivity&quot;&gt;

                  &lt;EditText
                      android:layout_marginTop=&quot;50dp&quot;
                      android:layout_width=&quot;match_parent&quot;
                      android:layout_height=&quot;wrap_content&quot;
                      android:hint=&quot;YourName&quot;
                      android:textSize=&quot;30dp&quot;
                      android:id=&quot;@+id/editText&quot;/&gt;

                  &lt;Button
                      android:layout_marginTop=&quot;50dp&quot;
                      android:layout_width=&quot;match_parent&quot;
                      android:layout_height=&quot;wrap_content&quot;
                      android:textSize=&quot;30dp&quot;
                      android:onClick=&quot;onButtonInsert&quot;
                      android:text=&quot;INSERT&quot;/&gt;

                  &lt;Button
                      android:layout_marginTop=&quot;20dp&quot;
                      android:layout_width=&quot;match_parent&quot;
                      android:layout_height=&quot;wrap_content&quot;
                      android:onClick=&quot;onButtonEdit&quot;
                      android:textSize=&quot;30dp&quot;
                      android:text=&quot;to Edit&quot;/&gt;

                  &lt;Button
                      android:layout_marginTop=&quot;20dp&quot;
                      android:layout_width=&quot;match_parent&quot;
                      android:layout_height=&quot;wrap_content&quot;
                      android:onClick=&quot;onButtonLoad&quot;
                      android:textSize=&quot;30dp&quot;
                      android:text=&quot;to Load&quot;/&gt;
              &lt;/LinearLayout&gt;
            </code>
          </pre>
          <div class="media-body">
            <h5 class="mt-0">activity_main.xmlの解説</h5>
            <ul>
              <li>LinearLayout</li>
              <p>
                LinearLayoutは、その中に配置されるオブジェクトを縦並びもしくは横並びに配置するレイアウトです。<br>
                今回は画面全体のオブジェクトを縦並びに配置したかったので、<code>android:orientation="vertical"</code>の指定をしています。
              </p>
              <li>EditText</li>
              <p>
                EditTextはユーザーが文字を直接入力できるオブジェクトです。<br>
                <code>android:hint=&quot;YourName&quot;</code>で表示することで、ここに何を入力すればいいのかをユーザーに伝えます。<br>
                次に入力された文字列を取得して処理するために<code>android:id=&quot;@+id/editText&quot;/&gt;</code>の形でIDを指定してjavaで扱えるようにしています。
              </p>
              <li>Button</li>
              <p>
                この画面には3つのボタンが設置されています。<br>
                それぞれにonClickを指定してjavaで個々のメソッドに対応させています。
              </p>
            </ul>
          </div><!-- /.media-body -->
        </div><!-- /.media -->

        <h5>MainActivity.java</h5>
        <div class="media">
          <pre>
            <code>
              package com.example.databaseapp;

              import androidx.appcompat.app.AppCompatActivity;

              import android.content.Intent;
              import android.database.sqlite.SQLiteDatabase;
              import android.os.Bundle;
              import android.view.View;
              import android.widget.EditText;
              import android.widget.Toast;

              public class MainActivity extends AppCompatActivity {

                  DBOpenHelper helper;

                  @Override
                  protected void onCreate(Bundle savedInstanceState) {
                      super.onCreate(savedInstanceState);
                      setContentView(R.layout.activity_main);

                      helper = new DBOpenHelper(getApplicationContext());
                  }

                  // to Editボタンクリック時の処理
                  public void onButtonEdit(View v) {
                      Intent intent = new Intent(this, EditActivity.class);
                      startActivity(intent);
                  }

                  public void onButtonLoad(View v) {
                      Intent intent = new Intent(this, LoadActivity.class);
                      startActivity(intent);
                  }

                  public void onButtonInsert(View v) {
                      SQLiteDatabase db = helper.getWritableDatabase();

                      EditText editTextName = findViewById(R.id.editText);
                      String name = editTextName.getText().toString();

                      if (name.equals("") || name.equals(null)) {
                          Toast.makeText(this, "名前を入力してください", Toast.LENGTH_SHORT).show();
                      } else {
                          helper.insertData(db, name);

                          Toast.makeText(this, "データベースに登録されました。", Toast.LENGTH_SHORT).show();
                          editTextName.setText("");
                      }
                  }
              }
            </code>
          </pre>
          <div class="media-body">
            <h5 class="mt-0">MainActivity.javaの解説</h5>
            <p>
              MainActivity.javaには「データベースへの登録」と「画面遷移」の2つの機能をもたせたメソッドを定義しています。
            </p>
            <ul>
              <li>onButtonInsertメソッド（データベースへの登録）</li>
              <p>
                データベースへの登録そのものの命令は、<code>helper.insertData(db, name);</code>の1文のみです。<br>
                引数に「db」と「name」があるため、それらの定義が必要です。
              </p>
              <ul>
                <li>引数「db」</li>
                <p>
                  <code>DBOpenHelper helper;</code>でDatabaseOpenHelperクラスを変数に格納し、<br>
                  <code>SQLiteDatabase db = helper.getWritableDatabase();</code>でインスタンス化しています。
                </p>
                <li>引数「name」</li>
                <p>
                  <code>EditText editTextName = findViewById(R.id.editText);</code>でactivity_main.xmlのEditTextを変数editTextNameとして格納しておきます。<br>
                  <code>String name = editTextName.getText().toString();</code>変数editTextNameと定義したEditTextの文字を文字列として取得してString型(文字列型)変数「name」に格納。<br>
                </p>
              </ul>
              <p>
                「db」「name」の定義ができたら、引数に渡してあげます。<br>
                データベース登録の命令文をif文で囲んでいるのは、EditTextが空白のまま登録ボタンを押した際に入力を促すためのものです。<br>
                このif文を書くことで空白のまま登録される可能性をなくすだけでなく、データベースアクセス面でのエラーにより不意にアプリが終了してしまう事態を未然に防ぐことができます。
              </p>
              <li>onButtonEditメソッド・onButtonLoadメソッド（画面遷移）</li>
              <p>
                画面遷移のボタンは2つあり、各メソッドでそれぞれの画面へ移動するように指定しています。<br>
                それぞれのメソッドには<code>intent</code>という同じ変数名が使われています。<br>
                これはメソッド内でのみ使えるローカル変数なので、同じ変数名にしても他に影響を及ぼしません。<br>
                詳しくは <a href="androidApp001.html">BasicTipsの画面遷移の実装</a>を参照してください。
              </p>
            </ul>
          </div><!-- /.media-body -->
        </div><!-- /.media -->

        <hr class="line-dark">

        <h4>2つめのアクティビティ（SELECT文・UPDATE文・DELETE文）</h4>
        <img src="images/DatabaseAppEmulator002.png" alt="DatabaseApp activity_edit エミュレータ画像">
        <h5>activity_edit.xml</h5>
        <div class="media">
          <pre>
            <code>
              &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
              &lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
                  xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
                  xmlns:tools=&quot;http://schemas.android.com/tools&quot;
                  android:orientation=&quot;vertical&quot;
                  android:layout_width=&quot;match_parent&quot;
                  android:layout_height=&quot;match_parent&quot;
                  tools:context=&quot;.EditActivity&quot;&gt;

                  &lt;EditText
                      android:layout_marginTop=&quot;50dp&quot;
                      android:layout_width=&quot;match_parent&quot;
                      android:layout_height=&quot;wrap_content&quot;
                      android:id=&quot;@+id/dataId&quot;
                      android:hint=&quot;ID:&quot;
                      android:textSize=&quot;30dp&quot;/&gt;

                  &lt;EditText
                      android:layout_marginTop=&quot;30dp&quot;
                      android:layout_width=&quot;match_parent&quot;
                      android:layout_height=&quot;wrap_content&quot;
                      android:id=&quot;@+id/updateName&quot;
                      android:hint=&quot;Please enter the name you want to edit.&quot;
                      android:textSize=&quot;20dp&quot;/&gt;

                  &lt;LinearLayout
                      android:layout_width=&quot;match_parent&quot;
                      android:layout_height=&quot;wrap_content&quot;
                      android:layout_marginLeft=&quot;5dp&quot;
                      android:layout_marginRight=&quot;5dp&quot;
                      android:orientation=&quot;horizontal&quot;&gt;

                      &lt;Button
                          android:layout_width=&quot;0dp&quot;
                          android:layout_height=&quot;wrap_content&quot;
                          android:layout_weight=&quot;1&quot;
                          android:layout_marginRight=&quot;2dp&quot;
                          android:textSize=&quot;15dp&quot;
                          android:onClick=&quot;onButtonLoad&quot;
                          android:text=&quot;load&quot;/&gt;

                      &lt;Button
                          android:layout_width=&quot;0dp&quot;
                          android:layout_height=&quot;wrap_content&quot;
                          android:layout_weight=&quot;1&quot;
                          android:layout_marginLeft=&quot;2dp&quot;
                          android:layout_marginRight=&quot;2dp&quot;
                          android:textSize=&quot;15dp&quot;
                          android:onClick=&quot;onButtonUpdate&quot;
                          android:text=&quot;UPDATE&quot;/&gt;

                      &lt;Button
                          android:layout_width=&quot;0dp&quot;
                          android:layout_height=&quot;wrap_content&quot;
                          android:layout_weight=&quot;1&quot;
                          android:layout_marginLeft=&quot;2dp&quot;
                          android:layout_marginRight=&quot;2dp&quot;
                          android:textSize=&quot;15dp&quot;
                          android:onClick=&quot;onButtonDelete&quot;
                          android:text=&quot;DELETE&quot;/&gt;

                      &lt;Button
                          android:layout_width=&quot;0dp&quot;
                          android:layout_height=&quot;wrap_content&quot;
                          android:layout_marginLeft=&quot;2dp&quot;
                          android:layout_weight=&quot;1&quot;
                          android:textSize=&quot;15dp&quot;
                          android:onClick=&quot;onButtonTop&quot;
                          android:text=&quot;to top&quot;/&gt;
                  &lt;/LinearLayout&gt;

                  &lt;TextView
                    android:layout_width=&quot;match_parent&quot;
                    android:layout_height=&quot;match_parent&quot;
                    android:id=&quot;@+id/loadView&quot;
                    android:textSize=&quot;30dp&quot;
                    android:text=&quot;Load View&quot;/&gt;
              &lt;/LinearLayout&gt;
            </code>
          </pre>
          <div class="media-body">
            <h5 class="mt-0">activity_edit.xmlの解説</h5>
            <ul>
              <li>EditText</li>
              <ul>
                <li>ID</li>
                <p>
                  <code>android:id="@+id/dataId"</code>："dataId"というidを割り当ててjavaで取得できるようにします。<br>
                  <code>android:hint="ID:"</code>：ユーザーに何を入力してほしいかを伝えます。
                </p>
                <li>Name</li>
                <code>android:id="@+id/updateName"</code>：UPDATE文の実行時に取得できるようにidを割り当てます。<br>
                id名を"updateName"とすることで、コードを書く際にもUPDATE文のためのEditTextだと認識できるようにすます。
                <code>android:hint="Please enter the name you want to edit."</code>：このヒントの和訳は「編集したい名前を入力してください。」となります。<br>
                EditTextへの入力内容をユーザーに伝えます。
              </ul>
              <li>Button</li>
              <p>
                このアクティビティには4つのボタンがあります。<br>
                各ボタンにはボタン識別用のテキストとjavaでの処理を書くためのonClickの指定がしてあります。<br>
                ４つのボタンは横並びで表示させるための<code>LinearLayout</code>でくくり、<code>android:orientation="horizontal"</code>の指定をしています。
              </p>
              <li>TextView</li>
              <p>
                データベースの内容を読み出して表示させるためのオブジェクトです。<br>
                javaで扱うためのidを指定して、そこにTextViewがあることを示すための文字列をあらかじめ表示させています。
              </p>
            </ul>
          </div><!-- /.media-body -->
        </div><!-- /.media -->

        <h5>EditActivity.java</h5>
        <div class="media">
          <pre>
            <code>
              package com.example.databaseapp;

              import androidx.appcompat.app.AppCompatActivity;

              import android.content.Intent;
              import android.database.Cursor;
              import android.database.sqlite.SQLiteDatabase;
              import android.os.Bundle;
              import android.view.View;
              import android.widget.EditText;
              import android.widget.TextView;
              import android.widget.Toast;

              import static com.example.databaseapp.DBOpenHelper.TABLE_NAME;

              public class EditActivity extends AppCompatActivity {

                  SQLiteDatabase db;
                  DBOpenHelper helper;

                  @Override
                  protected void onCreate(Bundle savedInstanceState) {
                      super.onCreate(savedInstanceState);
                      setContentView(R.layout.activity_edit);

                      helper = new DBOpenHelper(getApplicationContext());
                  }

                  public void onButtonTop(View v) {
                      Intent intent = new Intent(this, MainActivity.class);
                      startActivity(intent);
                  }

                  public void onButtonLoad(View v) {
                      db = null;

                      try {
                          db = new DBOpenHelper(this).getReadableDatabase();
                          Cursor c = null;
                          try {
                              c = db.query(TABLE_NAME, new String[]{&quot;id&quot;, &quot;name&quot;},null,null,null,null,null);

                              c.moveToFirst();

                              StringBuilder sBuilder = new StringBuilder();

                              for (int i = 0 ; i &lt; c.getCount(); i++) {
                                  sBuilder.append(c.getInt(0));
                                  sBuilder.append(&quot; | &quot;);
                                  sBuilder.append(c.getString(1) + '\n');
                                  c.moveToNext();
                              }
                              c.close();
                              ((TextView)findViewById(R.id.loadView)).setText(sBuilder);

                              Toast.makeText(this, &quot;データベースからの読み込み成功&quot;, Toast.LENGTH_SHORT).show();

                          } catch (Exception e){

                          } finally {
                              if (c != null) {
                                  c.close();
                                  c = null;
                              }
                          }
                      } catch (Exception e){

                      }finally {
                          if (db != null) {
                              db.close();
                              db = null;
                          }
                      }
                  }

                  public void onButtonUpdate(View v) {
                      db = null;

                      EditText editTextId = findViewById(R.id.dataId);
                      EditText editTextName = findViewById(R.id.updateName);

                      String id = editTextId.getText().toString();
                      String name = editTextName.getText().toString();

                      if (id.equals(&quot;&quot;) || id.equals(null)) {
                          Toast.makeText(this, &quot;IDを入力してください&quot;, Toast.LENGTH_SHORT).show();
                      } else if (name.equals(&quot;&quot;) || name.equals(null)) {
                          Toast.makeText(this, &quot;名前を入力してください&quot;, Toast.LENGTH_SHORT).show();
                      } else {
                          db = new DBOpenHelper(this).getWritableDatabase();
                          helper.updateData(db, name, id);

                          Toast.makeText(this, &quot;ID &quot; + id + &quot;のデータを更新しました。&quot;, Toast.LENGTH_SHORT).show();
                          editTextId.setText(&quot;&quot;);
                          editTextName.setText(&quot;&quot;);
                      }
                  }

                  public void onButtonDelete(View v) {
                      db = null;

                      EditText editTextId = findViewById(R.id.dataId);
                      EditText editTextName = findViewById(R.id.updateName);
                      String id = editTextId.getText().toString();

                      if (id.equals(&quot;&quot;) || id.equals(null)) {
                          Toast.makeText(this, &quot;IDを入力してください&quot;, Toast.LENGTH_SHORT).show();
                      } else {
                          db = new DBOpenHelper(this).getWritableDatabase();
                          helper.deleteData(db, id);

                          Toast.makeText(this, &quot;ID &quot; + id + &quot;のデータを消去しました。&quot;, Toast.LENGTH_SHORT).show();
                          editTextId.setText(&quot;&quot;);
                          editTextName.setText(&quot;&quot;);
                      }
                  }
              }
            </code>
          </pre>
          <div class="media-body">
            <h5 class="mt-0">EditActivity.javaの解説</h5>
            <p>
              EditActivity.javaには「データの抽出」「データの更新」「データの削除」「画面遷移」の4つの機能をもたせたメソッドを定義しています。
            </p>
            <ul>
              <li>onButtonTopメソッド（画面遷移）</li>
              <p>
                activity_main.xmlへの画面遷移のメソッドです。<br>
                詳しくは <a href="androidApp001.html">BasicTipsの画面遷移の実装</a>を参照してください。
              </p>
              <li>onButtonLoadメソッド（データの抽出）</li>
              <p>
                このメソッドについては同じメソッド名のものがLoadactivity.javaにあるので、そちらの解説をご覧ください。
              </p>
              <li>onButtonUpdateメソッド（データの更新）</li>
              <p>
                データベースへの登録そのものの命令は、<code>helper.updateData(db, name, id);</code>の1文のみです。<br>
                引数に「db」と「name」と「id」があるため、それらの定義が必要です。
              </p>
              <ul>
                <li>引数「db」</li>
                <p>
                  <code>DBOpenHelper helper;</code>でDatabaseOpenHelperクラスを変数に格納し、<br>
                  <code>SQLiteDatabase db = helper.getWritableDatabase();</code>でインスタンス化しています。
                </p>
                <li>引数「name」</li>
                <p>
                  <code>EditText editTextName = findViewById(R.id.updateName);</code>でactivity_edit.xmlのEditTextを変数editTextNameとして格納しておきます。<br>
                  <code>String name = editTextName.getText().toString();</code>変数editTextNameと定義したEditTextの文字を文字列として取得してString型(文字列型)変数「name」に格納します。
                </p>
                <li>引数「id」</li>
                <p>
                  <code>EditText editTextId = findViewById(R.id.dataId);</code>でactivity_edit.xmlのEditTextを変数editTextIdとして格納しておきます。<br>
                  <code>String id = editTextId.getText().toString();</code>変数editTextIdと定義したEditTextの文字を文字列として取得してString型(文字列型)変数「id」に格納します。
                </p>
              </ul>
              <p>
              「db」「name」「id」の定義ができたら、引数に渡してあげます。<br>
                データの更新の命令文をif文で囲んでいるのは、EditTextが空白のまま更新ボタンを押した際に入力を促すためのものです。<br>
                このif文を書くことで空白のまま登録される可能性をなくすだけでなく、データベースアクセス面でのエラーにより不意にアプリが終了してしまう事態を未然に防ぐことができます。
              </p>
              <li>onButtonDeleteメソッド（データの削除）</li>
              <p>
                データベースへの登録そのものの命令は、<code>helper.deleteData(db, id);</code>の1文のみです。<br>
                データのPRIMARY KEY（主キー）である「id」を選んで削除するため引数に「db」と「id」があります。<br>
                それらの定義が必要です。
              </p>
              <ul>
                <li>引数「db」</li>
                <p>
                  <code>DBOpenHelper helper;</code>でDatabaseOpenHelperクラスを変数に格納し、<br>
                  <code>SQLiteDatabase db = helper.getWritableDatabase();</code>でインスタンス化しています。
                </p>
                <li>引数「id」</li>
                <p>
                  <code>EditText editTextId = findViewById(R.id.dataId);</code>でactivity_edit.xmlのEditTextを変数editTextIdとして格納しておきます。<br>
                  <code>String id = editTextId.getText().toString();</code>変数editTextIdと定義したEditTextの文字を文字列として取得してString型(文字列型)変数「id」に格納します。
                </p>
              </ul>
              <p>
              「db」「id」の定義ができたら、引数に渡してあげます。<br>
                データの更新の命令文をif文で囲んでいるのは、EditTextが空白のまま更新ボタンを押した際に入力を促すためのものです。<br>
                このif文を書くことで空白のまま登録される可能性をなくすだけでなく、データベースアクセス面でのエラーにより不意にアプリが終了してしまう事態を未然に防ぐことができます。
              </p>
            </ul>
          </div><!-- /.media-body -->
        </div><!-- /.media -->

        <hr class="line-dark">

        <h4>3つめのアクティビティ（SELECT文）</h4>
        <img src="images/DatabaseAppEmulator003.png" alt="DatabaseApp activity_load エミュレータ画像">
        <h5>activity_load.xml</h5>
        <div class="media">
          <pre>
            <code>
              &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
              &lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
                  xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
                  xmlns:tools=&quot;http://schemas.android.com/tools&quot;
                  android:layout_width=&quot;match_parent&quot;
                  android:layout_height=&quot;match_parent&quot;
                  android:orientation=&quot;vertical&quot;
                  tools:context=&quot;.LoadActivity&quot;&gt;

                  &lt;LinearLayout
                      android:layout_width=&quot;match_parent&quot;
                      android:layout_height=&quot;wrap_content&quot;
                      android:layout_marginTop=&quot;10dp&quot;
                      android:layout_marginLeft=&quot;5dp&quot;
                      android:layout_marginRight=&quot;5dp&quot;&gt;

                      &lt;Button
                          android:layout_width=&quot;0dp&quot;
                          android:layout_height=&quot;wrap_content&quot;
                          android:layout_weight=&quot;1&quot;
                          android:layout_marginRight=&quot;2dp&quot;
                          android:text=&quot;Load&quot;
                          android:onClick=&quot;onButtonLoad&quot;
                          android:textSize=&quot;30dp&quot;/&gt;

                      &lt;Button
                          android:layout_width=&quot;0dp&quot;
                          android:layout_height=&quot;wrap_content&quot;
                          android:layout_weight=&quot;1&quot;
                          android:layout_marginLeft=&quot;2dp&quot;
                          android:onClick=&quot;onButtonTop&quot;
                          android:text=&quot;to top&quot;
                          android:textSize=&quot;30dp&quot;/&gt;
                  &lt;/LinearLayout&gt;

                  &lt;TextView
                      android:layout_width=&quot;match_parent&quot;
                      android:layout_height=&quot;match_parent&quot;
                      android:layout_marginTop=&quot;10dp&quot;
                      android:id=&quot;@+id/loadView&quot;
                      android:text=&quot;Load View&quot;
                      android:textSize=&quot;30dp&quot; /&gt;
              &lt;/LinearLayout&gt;
            </code>
          </pre>
          <div class="media-body">
            <h5 class="mt-0">activity_load.xmlの解説</h5>
            <ul>
              <li>全体のレイアウト（Linear Layout）</li>
              <p>
                画面全体に配置されるオブジェクトを縦並びで表示させるために<code>android:orientation="vertical"</code>を指定したLinear Layoutを使っています。
              </p>
              <li>ボタンのレイアウト（Linear Layout）</li>
              <p>
                2つのボタンを横並びで配置するためにLinearLayoutを使っています。
              </p>
              <li>2つのボタン</li>
              <p>
                2つのボタンについてはユーザーが識別するためのテキストとjavaで処理を書くために必要な<code>onClick</code>を指定してあります。
              </p>
              <li>データベースを表示させるためのオブジェクト（Text View）</li>
              <p>
                データベースの内容を読み出して表示させるためのオブジェクトです。<br>
                javaで扱うためのidを指定して、そこにTextViewがあることを示すための文字列をあらかじめ表示させています。
              </p>
            </ul>
          </div><!-- /.media-body -->
        </div><!-- /.media -->  

        <h5>LoadActivity.java</h5>
        <div class="media">
          <pre>
            <code>
              package com.example.databaseapp;

              import androidx.appcompat.app.AppCompatActivity;

              import android.content.Intent;
              import android.database.Cursor;
              import android.database.sqlite.SQLiteDatabase;
              import android.os.Bundle;
              import android.view.View;
              import android.widget.TextView;
              import android.widget.Toast;

              import static com.example.databaseapp.DBOpenHelper.TABLE_NAME;

              public class LoadActivity extends AppCompatActivity {

                  @Override
                  protected void onCreate(Bundle savedInstanceState) {
                      super.onCreate(savedInstanceState);
                      setContentView(R.layout.activity_load);
                  }

                  public void onButtonTop(View v) {
                      Intent intent = new Intent(this, MainActivity.class);
                      startActivity(intent);
                  }

                  public void onButtonLoad(View v) {
                      SQLiteDatabase db = null;

                      try {
                          db = new DBOpenHelper(this).getReadableDatabase();
                          Cursor c = null;
                          try {
                              c = db.query(TABLE_NAME, new String[]{&quot;;id&quot;;, &quot;;name&quot;;}, null, null, null, null, null);

                              c.moveToFirst();

                              StringBuilder sBuilder = new StringBuilder();

                              for (int i = 0; i &lt; c.getCount(); i++) {
                                  sBuilder.append(c.getInt(0));
                                  sBuilder.append(&quot;; | &quot;;);
                                  sBuilder.append(c.getString(1) + '\n');
                                  c.moveToNext();
                              }
                              c.close();
                              ((TextView)findViewById(R.id.loadView)).setText(sBuilder);

                              Toast.makeText(this, &quot;;データベースからの読み込み成功&quot;;, Toast.LENGTH_SHORT).show();

                          } catch (Exception e) {

                          } finally {
                              if (c != null) {
                                  c.close();
                                  c= null;
                              }
                          }
                      } catch (Exception e) {

                      } finally {
                          if (db != null) {
                              db.close();
                              db = null;
                          }
                      }
                  }
              }
            </code>
          </pre>
          <div class="media-body">
            <h5 class="mt-0">LoadActivity.javaの解説</h5>
            <ul>
              <li>onButtonLoadメソッド</li>
              <p>
                このアプリでは最も複雑なメソッドですが、SELECT文の記述は2つ目のtry文です。<br>
                AndroidアプリでSELECT文を扱う際には、<code>Cursor</code>を使います。<br>
                コードを順に見ていきます。
              </p>
              <ul>
                <li><code>db = null;</code></li>
                <p>
                  EditActivityクラスのグローバル変数で<code>SQLiteDatabase db;</code>と定義していたものに、nullを代入して<br>
                  変数dbをリセットしておきます。
                </p>
                <li>1つ目のtry-catch-finally文</li>
                <p>
                  <code>db = new DBOpenHelper(this).getReadableDatabase();</code>と<code>Cursor c = null;</code><br>
                  try-catch文を挟んで、変数dbにDBOpenHelperクラスを読込専用でインスタンス化します。<br>
                  同時にCursorにnullを代入しておきます。
                </p>
                <p>
                  finally文はtry文が成功する・しないにかかわらず実行されるものです。<br>
                  データベースは読込のあとアクセスした状態から確実に閉じておく必要があります。<br>
                  ここにdbがnullでない時の処理を書いておくことで、データベースを確実に閉じることができます。
                </p>
                <li><code>2つ目のtry-catch-finally文</code></li>
                <p>
                  1つ目のtry文にネストして2つ目のtry-catch-finally文が入ります。<br>
                  SELECT文を使ってデータをfor文で順番に抽出し、文字列を操作するStringBuilderクラスをインスタンス化したものに結合していく流れになります。
                </p>
                <p>
                  CursorもSELECT文を扱うものなので、使い終わったら<code>c.close();</code>という形で閉じておく必要があります。
                </p>
                <li>TextViewに抽出したデータを表示させる</li>
                <p>
                  <code>((TextView)findViewById(R.id.loadView)).setText(sBuilder);</code>
                  データを結合した文字列の状態で格納してある<code>sBuilder</code>を上記のコードを用いてTextViewに表示させます。
                </p>
              </ul>
            </ul>
          </div><!-- /.media-body -->
        </div><!-- /.media -->

        <hr class="line-dark">

        <h4>データベースアクセスのためのクラス</h4>
        <h5>DBOpenHelper.java</h5>
        <div class="media">
          <pre>
            <code>
              package com.example.databaseapp;
  
              import android.content.ContentValues;
              import android.content.Context;
              import android.database.sqlite.SQLiteDatabase;
              import android.database.sqlite.SQLiteOpenHelper;
  
              public class DBOpenHelper extends SQLiteOpenHelper {
  
                  // データベース名
                  static final String DB_NAME = &quot;name.db&quot;;
                  static final String TABLE_NAME = &quot;name&quot;;
  
                  // データベースのバージョン
                  // カラムの追加・変更を加えた場合カウントアップする
                  static final int DB_VERSION = 1;
  
                  public DBOpenHelper(Context context) {
                      super(context, DB_NAME, null, DB_VERSION);
                  }
  
                  @Override
                  public void onCreate(SQLiteDatabase db) {
  
                      db.execSQL(&quot;CREATE TABLE &quot; + TABLE_NAME
                              + &quot;(id INTEGER PRIMARY KEY AUTOINCREMENT,&quot;
                              + &quot;name TEXT&quot;
                              + &quot;);&quot;
                      );
  
                      // テーブルの初期値を指定する時はここに書く
  
                  }
  
                  // データベースバージョンアップ時の処理
                  @Override
                  public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
  
                  }
  
                  // INSERT文
                  public void insertData(SQLiteDatabase db, String name) {
                      ContentValues values = new ContentValues();
                      values.put(&quot;name&quot;, name);
  
                      db.insert(TABLE_NAME, null, values);
                  }
  
                  // UPDATE文
                  public void updateData(SQLiteDatabase db, String name, String id) {
                      ContentValues values = new ContentValues();
                      values.put(&quot;name&quot;, name);
  
                      db.update(TABLE_NAME, values, &quot;id = &quot; + id, null);
                  }
  
                  // DELETE文
                  public void deleteData(SQLiteDatabase db, String id) {
                      db.delete(TABLE_NAME, &quot;id = &quot; + id, null);
                  }
              }
            </code>
          </pre>
          <div class="media-body">
            <h5 class="mt-0">DBOpenHelper.javaの解説</h5>
            <h5>SQLiteOpenHelperクラスを継承させた後のフロー</h5>
            <ol>
              <li>SQLiteOpenHelperクラスを継承させる</li>
              <p>
                <code>public class DBOpenHelper extends SQLiteOpenHelper</code><br>
                クラスを定義する時に、この形でSQLiteOpenHelperクラスを継承させます。
                継承させた段階で、コンストラクタ・onCreateメソッド・onUpgradeメソッドを定義するように求められます。<br>
                Android Studioの指示通りに定義していけば問題ありません。
              </p>
              <li>コンストラクタを定義</li>
              <p>
                コンストラクタは、クラスが呼び出された時、自動で動くメソッドです。<br>
                コンストラクタ名＝クラス名という決まりがあるので注意が必要です。
              </p>
              <p>
                コンストラクタ内の<code>DB_NAME</code>と<code>DB_VERSION</code>はこちらで定義する必要があります。<br>
                そのどちらもメソッドを越えて使うのでグローバル定数として定義します。
              </p>
              <li>onCreateメソッドを定義</li>
              <p>
                onCreateメソッドもAndroid Studioの指示通りに定義していきますが、メソッド内には何も記述されていないはずです。<br>
                <code>db.execSQL();</code>を使ってカッコ内にテーブルを作成するSQL文を記述し、テーブルを定義します。
              </p>
              <p>
                テーブルを定義した後、その下に、INSERT文を記述することで、初期のデータをデータベースに渡しておくことが可能です。
              </p>
              <li>onUpgradeメソッドを定義</li>
              <p>
                データベースの構造などを更新した場合ここでバージョン管理を行います。<br>
                今回のコードではメソッド内の記述はしていません。
              </p>
              <li>データベース関連の任意のメソッドを定義する</li>
              <p>
                データベースに関するメソッド（処理）は主にINSERT文・UPDATE文・DELETE文・SELECT文に分けられます。<br>
                今回のコードに関してはSELECT文以外の処理をメソッドメソッドとして定義しています。<br>
                SELECT文に関しては、変数の参照等をうまく指定できなかったこともあり各Activityでメソッドを作りました。
              </p>
            </ol>
          </div><!-- /.media-body -->
        </div><!-- /.media -->
      </section>
    <!-- footer -->
    <footer class="footer">
      <div id="copyright"></div>
    </footer>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
    
    <!-- my Javascript file -->
    <script src="../JavaScript/navbar.js"></script>
    <script src="../JavaScript/copyright.js"></script>
  </body>
</html>